#install.packages("seqinr", dependencies = TRUE)
library(seqinr)
#install.packages("seqinr", dependencies = TRUE)
library(seqinr)
#if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
#BiocManager::install("Biostrings")
library(Biostrings)
#install.packages("seqinr", dependencies = TRUE)
library(seqinr)
#if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
#BiocManager::install("Biostrings")
library(Biostrings)
setwd("C:/Users/leona/Downloads")
install.packages("seqinr", dependencies = TRUE)
library(seqinr)
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
library(Biostrings)
BiocManager::install("pwalign")
library(pwalign)
refs <- read.fasta("reference_sequences.fasta", as.string = TRUE)
eDNA_dam <- read.fasta("edna_samples_Dam.fasta", as.string = TRUE)
eDNA_nodam <- read.fasta("edna_samples_noDam.fasta", as.string = TRUE)
class(refs)
str(refs)
length(refs)
length(eDNA_dam)
length(eDNA_nodam)
nchar(refs[[1]])
nchar(refs[[1]])
sapply(refs, nchar)
sapply(eDNA_dam, nchar)
sapply(eDNA_nodam, nchar)
table(strsplit(refs[[1]], "")[[1]])
base_composition <- function(seq) {
a <- table(strsplit(seq, "")[[1]])
return(a)
}
base_composition(refs[[2]])
lapply(eDNA_dam, base_composition)
#lapply(eDNA_nodam, base_composition)
#lapply(eDNA_nodam, base_composition)
```
lapply(eDNA_nodam, base_composition)
sturgeon_ref_bases <- strsplit(refs[[1]], "")[[1]]
catfish_ref_bases <- strsplit(refs[[2]], "")[[1]]
matches <- sturgeon_ref_bases == catfish_ref_bases
matches
sum(matches)
percent_identity <- sum(matches)/length(matches)*100
percent_identity
pid_function <- function(seq1,seq2){
split1 <- strsplit(seq1, "")[[1]]
split2 <- strsplit(seq2, "")[[1]]
mymatches <- split1 == split2
pid <- sum(mymatches)/length(mymatches)*100
return(pid)
}
pid_function(refs[[1]],eDNA_dam[[1]])
ref_alignment <- pairwiseAlignment(refs[[1]], refs[[2]], type="global")
ref_alignment
pid(ref_alignment)
sturgeon_ref <- refs[[1]]
catfish_ref <- refs[[2]]
sample01_align <- pairwiseAlignment(eDNA_dam[[1]], sturgeon_ref, type="global")
sample01_align
pid(sample01_align)
sample01_align <- pairwiseAlignment(eDNA_dam[[1]], catfish_ref, type="global")
sample01_align
pid(sample01_align)
myPID <- function(eDNA_seq, ref_seq){
myalign <- pairwiseAlignment(eDNA_seq, ref_seq, type="global")
return(pid(myalign))
}
myPID(eDNA_dam[[1]], catfish_ref)
pid_sturgeon_Dam <- sapply(eDNA_dam, myPID, ref_seq = sturgeon_ref)
pid_catfish_Dam <- sapply(eDNA_dam, myPID, ref_seq = catfish_ref)
pid_sturgeon_noDam <- sapply(eDNA_nodam, myPID, ref_seq = sturgeon_ref)
pid_catfish_noDam <- sapply(eDNA_nodam, myPID, ref_seq = catfish_ref)
results_table <- data.frame(
SampleID = c(names(pid_sturgeon_Dam), names(pid_sturgeon_noDam)),
Site = rep(c("Dam", "No Dam"), times = c(length(pid_sturgeon_Dam), length(pid_sturgeon_noDam))),
PID_to_Sturgeon = c(pid_sturgeon_Dam, pid_sturgeon_noDam),
PID_to_Catfish  = c(pid_catfish_Dam, pid_catfish_noDam),
row.names = NULL
)
results_table
# Chunk 29
pid_sturgeon_noDam <- sapply(eDNA_nodam, myPID, ref_seq = sturgeon_ref)
#install.packages("seqinr", dependencies = TRUE)
library(seqinr)
#if (!requireNamespace("BiocManager", quietly = TRUE))
#    install.packages("BiocManager")
#BiocManager::install("Biostrings")
library(Biostrings)
#BiocManager::install("pwalign")
library(pwalign)
refs <- read.fasta("reference_sequences.fasta", as.string = TRUE)
eDNA_dam <- read.fasta("edna_samples_Dam.fasta", as.string = TRUE)
eDNA_nodam <- read.fasta("edna_samples_noDam.fasta", as.string = TRUE)
class(refs)
refs <- read.fasta("reference_sequences.fasta", as.string = TRUE)
setwd("~/Desktop/lizards")
setwd C:\Users\leona\OneDrive
cd C:\Users\leona\OneDrive
setwd(\Users\leona\OneDrive)
setwd("~onedrive/Desktop/lizards")
setwd ("~/Users/leona/OneDrive/Desktop/lizards)
install.packages(c("Biostrings", "msa", "rentrez"))
setwd ("~/Users/leona/OneDrive/Desktop/lizards)
setwd("~/Desktop/R course")
setwd ("~/Users/leona/OneDrive/Desktop/lizards")
"C:\Users\leona\OneDrive\Desktop\lizards"
"C:/Users/leona/OneDrive/Desktop/lizards"
install.packages(c("Biostrings", "msa", "rentrez"))
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager", force=TRUE)
BiocManager::install(c("Biostrings", "msa"))
library(Biostrings)
library(msa)
library(rentrez)
acc <- c(
"NC_012920.1",  # Homo sapiens mitochondrion
"NC_001643.1",  # Pan troglodytes mitochondrion
"NC_005089.1",  # Mus musculus mitochondrion
"NC_002008.4",  # Canis lupus familiaris mitochondrion
"NC_006853.1"   # Bos taurus mitochondrion
)
fasta_text <- entrez_fetch(db = "nuccore"
id = acc, rettype = "fasta"
library(msa)
library(rentrez)
library(Biostrings)
acc <- c(
"NC_012920.1",  # Homo sapiens mitochondrion
"NC_001643.1",  # Pan troglodytes mitochondrion
"NC_005089.1",  # Mus musculus mitochondrion
"NC_002008.4",  # Canis lupus familiaris mitochondrion
"NC_006853.1"   # Bos taurus mitochondrion
)
fasta_text <- entrez_fetch(db = "nuccore", id = acc, rettype = "fasta", retmode = "text")
str(fasta_text)
fasta_text
setwd("C:/Users/leona/Downloads")
setwd("C:/Users/leona/Downloads")
library(Biostrings)
install.packages("biocmanager")
BiocManager::install(biostrings)
library(Biostrings)
readDNAStringSet("Schulte_pairwiseAlignmentSequences.fasta")
names(seqs)
names(seqnames)
aln<- pairwiseAlignment(seqs[1], seqs[2])
aln<- pairwiseAlignment(1,2)
seqs
seq
name seq
aln<- pairwiseAlignment(biostrings)
pwalign::pairwiseAlignment()
pwalign::pairwiseAlignment(seq(1))
names(seqs)
pwalign::compareStrings(1,2)
pairwiseAlignment(OM736837;Micropterus_salmoides;COI, NC_011361;Micropterus_dolomieu;COI, Unknown_sequence_1)
seqs <- readDNAStringSet("Schulte_pairwiseAlignmentSequences.fasta")
name (seqs)
name (seqs)
names (seqs)
pairwiseAlignment(seqs[1], seqs[2], seqs[3])
pwalign::pairwiseAlignment(seqs[1], seqs[2], seqs[3])
names (seqs)
[1]<- OM736837;Micropterus_salmoides
[1]<- OM736837;Micropterus_salmoides;COI
readDNAStringSet("Schulte_pairwiseAlignmentSequences.fasta")
names(seqs)
pairwiseAlignment(seq[1], seq[2])
pwalign::pairwiseAlignment()
aln<- pwalign::pairwiseAlignment(seqs[1], seqs[2])
library(Biostrings)
library(pwalign)
seqs <- readDNAStringSet("Schulte_pairwiseAlignmentSequences.fasta")
names(seqs)
aln<- pwalign::pairwiseAlignment(seqs[1], seqs[2])
View(seqs)
setwd("C:/Users/leona/Downloads")
seqs <- readDNAStringSet("Schulte_pairwiseAlignmentSequences.fasta")
seqs
aln<- pwalign::pairwiseAlignment(seqs[1], seqs[2])
View(aln)
pairwiseAlignment(seqs[1], seqs[2])
pairwiseAlignment(seqs[1], seqs[3])
setwd("C:/Users/leona/OneDrive/Desktop/Bioinformatics")
getwd()
list.files()
read_fasta_sequence <- function(sequence.Escherichia.coli)
setwd("C:/Users/leona/OneDrive/Desktop/Bioinformatics")
ecoli<- readLines("sequence.Escherichia.coli")
ecoli<- readLines("sequence.Escherichia.coli.fasta")
ecoli[1:5]
ecoli_seq <- paste(ecoli_seq, collapse = "")
ecoli_seq <- ecoli[!grepl("^>", ecoli)]
ecoli_seq <- paste(ecoli_seq, collapse = "")
substr(ecoli_seq, 1, 50)
n <- nchar(ecoli_seq)
A <- sum(strsplit(ecoli_seq, "")[[1]] == "A")
T <- sum(strsplit(ecoli_seq, "")[[1]] == "T")
G <- sum(strsplit(ecoli_seq, "")[[1]] == "G")
C <- sum(strsplit(ecoli_seq, "")[[1]] == "C")
A_pct <- (A/n)*100
T_pct <- (T/n)*100
G_pct <- (G/n)*100
C_pct <- (C/n)*100
GC_pct <- G_pct + C_pct
round(c(A=A_pct, T=T_pct, G=G_pct, C=C_pct, GC=GC_pct), 2)
setwd("C:/Users/leona/OneDrive/Desktop/Bioinformatics")
ecoli <- readLines(sequence.Escherichia.coli)
ecoli <- readLines(sequence.Escherichia.coli.fasta)
ecoli <- readLines(E.coli_sequence.fasta)
setwd("C:/Users/leona/OneDrive/Desktop/Bioinformatics")
ecoli <- readLines(E.coli_sequence.fasta)
ecoli <- readLines("E.coli_sequence.fasta")
ecoli
ecoli<- ecoli[-1]
if (!requireNamespace("BiocManager", quietly = TRUE))
install.packages("BiocManager")
BiocManager::install("Biostrings")
library(Biostrings)
ecoli <- readDNAStringSet("E.coli_sequence.fasta")
ecoli
counts <- letterFrequency(ecoli, letters = c("A","T","G","C"))
counts
total <- sum(counts)
A <- (counts["A"] / total) * 100
T <- (counts["T"] / total) * 100
G <- (counts["G"] / total) * 100
C <- (counts["C"] / total) * 100
GC <- G + C
round(c(A=A, T=T, G=G, C=C, GC=GC), 2)
A <- (counts[, "A"] / total) * 100
T <- (counts[, "T"] / total) * 100
G <- (counts[, "G"] / total) * 100
C <- (counts[, "C"] / total) * 100
GC <- G + C
round(c(A=A, T=T, G=G, C=C, GC=GC), 2)
Volcanium <- readDNAStringSet("Volcanium_sequence.fasta")
counts <- letterFrequency(Volcanium, letters = c("A","T","G","C"))
counts
total <- sum(counts)
total
A <- (counts[, "A"] / total) * 100
T <- (counts[, "T"] / total) * 100
G <- (counts[, "G"] / total) * 100
C <- (counts[, "C"] / total) * 100
GC <- G + C
round(c(A=A, T=T, G=G, C=C, GC=GC), 2)
A
A
T
C
G
GC
library(dplyr)
library(dplyr)
setwd("C:/Users/leona/OneDrive/Desktop/Bioinformatics/BLAST_Project")
library(dplyr)
install.packages("here")
library(here)
setwd("C:/Users/leona/OneDrive/Desktop/Bioinformatics/BLAST_Project")
library(seqinr)
library(rentrez)
library(stringr)
library(Biostrings)
?entrez_search
?entrez_fetch
seq <- entrez_fetch(db="nucleotide",
id="NC_001477",
rettype= "fasta")
seq
substr(seq, 1, 100)
seq_split <- stringr::str_split(seq, "")
seq_split
write(seq, "Denque_seq.fasta")
dengueseq <- read.fasta("Dengue_seg.fasta")
dengueseq <- read.fasta("Dengue_seq.fasta")
library(dplyr)
write(seq, "Dengue_seq.fasta")
dengueseq <- read.fasta("Dengue_seq.fasta")
library(biomartr)
install.library(biomartr)
install.packages(biomartr)
class(dengueseq)
length(dengueseq)
length(dengueseq$NC_001477.1)
Dengue.seq<- DNAStringSet(Dengue_seq.fasta)
Dengue.seq<- DNAStringSet("Dengue_seq.fasta")
Dengueseq<- DNAStringSet("Dengue_seq.fasta")
Dengueseq<- readDNAStringSet("Dengue_seq.fasta")
count<- letterFrequency(Dengueseq, letters = c("A","T","G","C"))
count
total<- sum(count)
A <- (counts[, "A"] / total) * 100
T <- (counts[, "T"] / total) * 100
G <- (counts[, "G"] / total) * 100
C <- (counts[, "C"] / total) * 100
seq_split
GC<- G+C
A
A <- (counts[, "A"] / total) * 100
T <- (counts[, "T"] / total) * 100
G <- (counts[, "G"] / total) * 100
C <- (counts[, "C"] / total) * 100
GC<- G+C
A
T
total
(counts[, "A"
counts[, "A"]
counts[, "A"]
A <- (count[, "A"] / total) * 100
T <- (count[, "T"] / total) * 100
G <- (count[, "G"] / total) * 100
C <- (count[, "C"] / total) * 100
GC<- G+C
A
T
G
C
GC
count[, "A"]
count[, "T"]
count[, "G"]
count[, "C"]
table(seq)
library(seqinr)
class(seq)
GC(seq)
head(Dengueseq)
